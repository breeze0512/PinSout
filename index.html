


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <link rel="canonical" href="https://breeze0512.github.io/PinSout/">
      
      
      <link rel="shortcut icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.3">
    
    
      
        <title>PinSout Document</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.947af8d5.min.css">
      
        <link rel="stylesheet" href="assets/stylesheets/palette.7f672a1f.min.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="drac-purple" data-md-color-accent="drac-purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pinsout-point-in-space-out" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://breeze0512.github.io/PinSout" title="PinSout Document" class="md-header-nav__button md-logo" aria-label="PinSout Document">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            PinSout Document
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Getting Start
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/aistairc/PinSout/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    aistairc/dprt-mf
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
          

<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="." class="md-tabs__link md-tabs__link--active">
        Getting Start
      </a>
    
  </li>

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://breeze0512.github.io/PinSout" title="PinSout Document" class="md-nav__button md-logo" aria-label="PinSout Document">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    PinSout Document
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/aistairc/PinSout/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    aistairc/dprt-mf
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Getting Start
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="." title="Getting Start" class="md-nav__link md-nav__link--active">
      Getting Start
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pointcloud" class="md-nav__link">
    PointCloud
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citygml" class="md-nav__link">
    CityGML
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    Dependencies
  </a>
  
    <nav class="md-nav" aria-label="Dependencies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pointnet" class="md-nav__link">
    PointNet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#point-cloud-library-pcl" class="md-nav__link">
    Point Cloud Library (PCL)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3dcitydb" class="md-nav__link">
    3DCityDB
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#system-requirements" class="md-nav__link">
    System Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-start-with-example" class="md-nav__link">
    Quick Start with Example
  </a>
  
    <nav class="md-nav" aria-label="Quick Start with Example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#--data-information" class="md-nav__link">
    -) Data information
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-preparing-to-use-pointnet" class="md-nav__link">
    1) Preparing to use PointNet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-generate-citygml-data-from-point-cloud" class="md-nav__link">
    2) Generate CityGML data from point cloud
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    Usage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#license" class="md-nav__link">
    License
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contact" class="md-nav__link">
    Contact
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pointcloud" class="md-nav__link">
    PointCloud
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citygml" class="md-nav__link">
    CityGML
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    Dependencies
  </a>
  
    <nav class="md-nav" aria-label="Dependencies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pointnet" class="md-nav__link">
    PointNet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#point-cloud-library-pcl" class="md-nav__link">
    Point Cloud Library (PCL)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3dcitydb" class="md-nav__link">
    3DCityDB
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#system-requirements" class="md-nav__link">
    System Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-start-with-example" class="md-nav__link">
    Quick Start with Example
  </a>
  
    <nav class="md-nav" aria-label="Quick Start with Example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#--data-information" class="md-nav__link">
    -) Data information
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-preparing-to-use-pointnet" class="md-nav__link">
    1) Preparing to use PointNet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-generate-citygml-data-from-point-cloud" class="md-nav__link">
    2) Generate CityGML data from point cloud
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    Usage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#license" class="md-nav__link">
    License
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contact" class="md-nav__link">
    Contact
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/aistairc/PinSout/edit/master/docs/index.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <p><img alt="pinsout" src="img/PinSout.png" /></p>
<h1 id="pinsout-point-in-space-out"><em>PinSout</em> (<em>P</em>oint <em>IN</em> <em>S</em>pace <em>OUT</em>)<a class="headerlink" href="#pinsout-point-in-space-out" title="Permanent link"></a></h1>
<p>Accelerating 3D Indoor Space Construction from Point Clouds with Deep Learning</p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link"></a></h2>
<p>In general, the procedure for creating a 3D model has five steps that are Data Segmentation, Components separation, Surface generation, Components assembling and Alignment. 
Actually, it is performed using man-power, all tasks involve very high time-consuming and labor-intensive. 
We think about how can improve the processes quickly and easily.</p>
<p>So, we start a project to generate 3d models from raw point data automatically.
Before we start, we need two pieces of background.</p>
<ul>
<li>
<h3 id="pointcloud">PointCloud<a class="headerlink" href="#pointcloud" title="Permanent link"></a></h3>
<p><strong>Point cloud</strong> is a set of data point which is reflected a real-world by 3D scanning. 
The important thing is point cloud can include several features, including geometry information, color, intensity and so on.
Specially, we can use geometry information of point cloud data for constructing a 3D model</p>
</li>
<li>
<h3 id="citygml"><a href="https://www.opengeospatial.org/standards/citygml">CityGML</a><a class="headerlink" href="#citygml" title="Permanent link"></a></h3>
<p><strong>OGC CityGML</strong> is an open data model and XML-based format for the storage and exchange of semantic 3D city models. 
It is an application schema for the Geography Markup Language version 3.1.1 (GML3), the extendible <strong>international standard</strong> for spatial data exchange issued by the <strong>Open Geospatial Consortium (OGC)</strong> and the <strong>ISO TC211</strong>. 
The aim of the development of CityGML is to reach a common definition of the basic entities, attributes, and relations of a 3D city model.</p>
</li>
</ul>
<p>From the process of manually building the 3D model(<strong>CityGML</strong>) from the point cloud data, we derived the three steps: Semantic Segmentation, Polygonization, and Featurization. </p>
<ol>
<li><strong><em>Semantic Segmentation</em></strong> - Classify semantics from point</li>
<li><strong><em>Polygonization</em></strong> - Construct polygons from point</li>
<li><strong><em>Featurizaiotn</em></strong> - Mapping between semantic features and surfaces</li>
</ol>
<p>So, in this project, our purpose is making each step results automatically as below figure.
<div>
  <img width="800" src=https://user-images.githubusercontent.com/10336074/63823756-e7ebb000-c98f-11e9-97a0-8454cf0be5e1.png>
</div></p>
<h2 id="dependencies">Dependencies<a class="headerlink" href="#dependencies" title="Permanent link"></a></h2>
<p>We used the following open sources in each step (<em>Semantic segmentation, Polygonization, and Featurizaiotn</em>).
1. <a href="https://github.com/charlesq34/pointnet">PointNet</a> - Deep Learning on Point Sets for 3D Classification and Segmentation
2. <a href="https://github.com/strawlab/python-pcl">Python-PCL</a> - Small python binding to the point cloud library
3. <a href="https://github.com/3dcitydb/3dcitydb">3DCityDB</a> - Free 3D geodatabase to store, represent, and manage virtual 3D city models</p>
<ul>
<li>
<h4 id="pointnet">PointNet<a class="headerlink" href="#pointnet" title="Permanent link"></a></h4>
<p>Deep learning can help to analyze massive point cloud data. 
  In terms of classification, clustering, segmentation, annotation and so on. 
  PointNet is a popular open deep neural network for analyzing point cloud data. 
  We can segment the indoor components such as walls, ceilings, floor, windows, and door. 
  Using the Stanford data to do the test.</p>
</li>
<li>
<h4 id="point-cloud-library-pcl">Point Cloud Library (PCL)<a class="headerlink" href="#point-cloud-library-pcl" title="Permanent link"></a></h4>
<div class="codehilite"><pre><span></span><code>  <span class="nv">PCL</span> <span class="nv">is</span> <span class="nv">the</span> <span class="nv">open</span><span class="o">-</span><span class="nv">source</span> <span class="nv">project</span> <span class="k">for</span> <span class="mi">2</span><span class="nv">D</span><span class="o">/</span><span class="mi">3</span><span class="nv">D</span> <span class="nv">image</span> <span class="nv">and</span> <span class="nv">point</span> <span class="nv">cloud</span> <span class="nv">processing</span>. 
  <span class="nv">it</span> <span class="nv">contains</span> <span class="nv">numerous</span> <span class="nv">state</span><span class="o">-</span><span class="nv">of</span><span class="o">-</span><span class="nv">the</span><span class="o">-</span><span class="nv">art</span> <span class="nv">algorithms</span> <span class="nv">and</span> <span class="nv">create</span> <span class="nv">surfaces</span> <span class="nv">from</span> <span class="nv">point</span> <span class="nv">clouds</span> <span class="nv">and</span> <span class="nv">visualize</span> <span class="nv">them</span>. 
  <span class="nv">Usually</span>, <span class="nv">the</span> <span class="nv">indoor</span> <span class="nv">space</span> <span class="nv">is</span> <span class="nv">a</span> <span class="nv">closed</span> <span class="nv">space</span> <span class="nv">consisting</span> <span class="nv">of</span> <span class="nv">a</span> <span class="nv">planar</span> <span class="nv">surface</span>, <span class="nv">so</span> <span class="nv">we</span> <span class="nv">are</span> <span class="nv">using</span> <span class="nv">the</span> <span class="nv">RANSAC</span> <span class="nv">to</span> <span class="nv">extract</span> <span class="nv">the</span> <span class="nv">plane</span>.
</code></pre></div>


</li>
<li>
<h4 id="3dcitydb">3DCityDB<a class="headerlink" href="#3dcitydb" title="Permanent link"></a></h4>
<div class="codehilite"><pre><span></span><code>  <span class="k">Using</span> <span class="n">the</span> <span class="mi">3</span><span class="n">DCityDB</span> <span class="k">to</span> <span class="n">deal</span> <span class="k">with</span> <span class="n">the</span> <span class="n">CityGML</span><span class="p">.</span> 
  <span class="n">We</span> <span class="k">are</span> <span class="n">mapping</span> <span class="n">the</span> <span class="n">geometry</span> <span class="k">and</span> <span class="n">semantic</span> <span class="k">using</span> <span class="n">the</span> <span class="k">table</span> <span class="k">defined</span> <span class="k">in</span> <span class="mi">3</span><span class="n">DCityDB</span><span class="p">.</span> 
  <span class="mi">3</span><span class="n">DCityDB</span> <span class="k">is</span> <span class="n">the</span> <span class="k">free</span> <span class="n">geodatabase</span> <span class="k">to</span> <span class="n">store</span><span class="p">,</span> <span class="n">represent</span><span class="p">,</span> <span class="k">and</span> <span class="n">manage</span> <span class="n">virtual</span> <span class="mi">3</span><span class="n">D</span> <span class="n">city</span> <span class="n">models</span> <span class="k">on</span> <span class="n">top</span> <span class="k">of</span> <span class="n">a</span> <span class="n">standard</span> <span class="n">spatial</span> <span class="n">relational</span> <span class="k">database</span><span class="p">.</span> 
  <span class="k">Database</span> <span class="k">schema</span> <span class="n">implements</span> <span class="n">the</span> <span class="n">CityGML</span> <span class="n">standard</span><span class="p">.</span>
</code></pre></div>


</li>
</ul>
<h2 id="system-requirements">System Requirements<a class="headerlink" href="#system-requirements" title="Permanent link"></a></h2>
<p>This release has been tested on Linux Ubuntu 16.04 with</p>
<blockquote>
<p>Anaconda - Python 2.7.6<br />
PostgreSQL DBMS &gt;= 9.3 with PostGIS extension &gt;= 2.0</p>
</blockquote>
<h2 id="installation">Installation<a class="headerlink" href="#installation" title="Permanent link"></a></h2>
<ul>
<li>
<p><a href="https://www.postgresql.org/download/">PostgreSQL with PostGIS</a></p>
</li>
<li>
<p><a href="https://www.anaconda.com/distribution/">Anaconda</a></p>
</li>
<li>
<p><a href="https://github.com/charlesq34/pointnet">PointNet</a>  </p>
</li>
<li>
<p><a href="https://github.com/strawlab/python-pcl">Python-PCL</a>  </p>
</li>
<li>
<p><a href="https://www.3dcitydb.org/3dcitydb/d3ddatabase/">3DCityDB</a>  </p>
</li>
<li>
<p><a href="https://www.3dcitydb.org/3dcitydb/d3dimpexp/">3DCityDB importer&amp;exporter</a></p>
</li>
<li>
<p><a href="https://www.iai.kit.edu/1302.php">FZK Viewer</a></p>
</li>
<li>
<p><a href="https://www.danielgm.net/cc/">CloudCompare</a></p>
</li>
</ul>
<h2 id="quick-start-with-example">Quick Start with Example<a class="headerlink" href="#quick-start-with-example" title="Permanent link"></a></h2>
<h3 id="--data-information">-) Data information<a class="headerlink" href="#--data-information" title="Permanent link"></a></h3>
<ul>
<li><a href="http://buildingparser.stanford.edu/dataset.html">Stanford 2D-3D-Semantics Dataset</a></li>
<li>Office type rooms, except complex types ( Convert all offices in area_1)</li>
</ul>
<h3 id="1-preparing-to-use-pointnet">1) Preparing to use <strong>PointNet</strong><a class="headerlink" href="#1-preparing-to-use-pointnet" title="Permanent link"></a></h3>
<ol>
<li>
<p>Run <a href="https://github.com/charlesq34/pointnet">PointNet</a> and go to the <strong>sem_seg</strong> folder.</p>
<ul>
<li>Download 3D indoor parsing dataset (S3DIS Dataset) for testing and visualization. 
Dataset version 1.2 is used in this work.</li>
<li>Before we start collect_indoor3d_data.py, we change the entry in the <strong>"meta/class_names.txt"</strong> to ceiling, floor, wall, door and window</li>
<li>Change the value of <strong>"g_class2color and g_easy_view_labels"</strong> in the "indoor3d_util.py" 
<div class="highlight"><pre><span></span><code><span class="n">g_classes</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s1">&#39;meta/class_names.txt&#39;</span><span class="p">))]</span>
<span class="sd">&quot;&quot;&quot;g_class2color = {&#39;ceiling&#39;:   [0, 255, 0],  # 0</span>
<span class="sd">             &#39;floor&#39;:    [0, 0, 255],      # 1</span>
<span class="sd">             &#39;wall&#39;:     [0, 255, 255],    # 2</span>
<span class="sd">             &#39;beam&#39;:     [255, 255, 0],    # 3</span>
<span class="sd">             &#39;column&#39;:   [255, 0, 255],    # 4</span>
<span class="sd">             &#39;window&#39;:   [100, 100, 255],  # 5</span>
<span class="sd">             &#39;door&#39;:     [200, 200, 100],  # 6</span>
<span class="sd">             &#39;table&#39;:    [170, 120, 200],  # 7</span>
<span class="sd">             &#39;chair&#39;:    [255, 0, 0],      # 8</span>
<span class="sd">             &#39;sofa&#39;:     [200, 100, 100],  # 9</span>
<span class="sd">             &#39;bookcase&#39;: [10, 200, 100],   # 10</span>
<span class="sd">             &#39;board&#39;:    [200, 200, 200],  # 11</span>
<span class="sd">             &#39;clutter&#39;:  [50, 50, 50]}     # 12</span>
<span class="sd">       g_easy_view_labels = [7, 8, 9, 10, 11, 1]&quot;&quot;&quot;</span>
<span class="n">g_class2color</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ceiling&#39;</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>  <span class="c1"># 0</span>
             <span class="s1">&#39;floor&#39;</span><span class="p">:</span>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">],</span>        <span class="c1"># 1</span>
             <span class="s1">&#39;wall&#39;</span><span class="p">:</span>     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">],</span>       <span class="c1"># 2                 </span>
             <span class="s1">&#39;window&#39;</span><span class="p">:</span>   <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">255</span><span class="p">],</span>  <span class="c1"># 3</span>
             <span class="s1">&#39;door&#39;</span><span class="p">:</span>     <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">]}</span>  <span class="c1"># 4   </span>
<span class="n">g_easy_view_labels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>$ python collect_indoor3d_data.py
</code></pre></div>
<div class="highlight"><pre><span></span><code>$ python gen_indoor3d_h5.py
</code></pre></div></li>
<li>To prepare your HDF5 data, you need to firstly download 3D indoor parsing dataset and then use training if no model has been learned</li>
</ul>
</li>
<li>
<p>Training  </p>
<ul>
<li>Change the value of <strong>"NUM_CLASSES"</strong> and directory path in "train.py"
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot; NUM_CLASSES = 13 &quot;&quot;&quot;</span>
<span class="n">NUM_CLASSES</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">ALL_FILES</span> <span class="o">=</span> <span class="n">provider</span><span class="o">.</span><span class="n">getDataFiles</span><span class="p">(</span><span class="s1">&#39;Your indoor3d_sem_seg_hdf5_data path/all_files.txt&#39;</span><span class="p">)</span>
<span class="n">room_filelist</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;Your indoor3d_sem_seg_hdf5_data path/room_filelist.txt&#39;</span><span class="p">)]</span>
</code></pre></div></li>
<li>Once you have downloaded prepared HDF5 files or prepared them by yourself, to start training:
<div class="highlight"><pre><span></span><code>$ python train.py --log_dir log_5cls --test_area <span class="m">6</span>
</code></pre></div>
In default, a simple model based on vanilla PointNet is used for training. 
Area_6 is used for the test set.</li>
</ul>
</li>
<li>
<p>Test  </p>
<ul>
<li>Testing requires a download of 3D indoor parsing data and preprocessing with collect_indoor3d_data.py</li>
</ul>
<p>After training, use batch_inference.py command to segment rooms in the test set. 
In this work, we use 6-fold training that trains six models. </p>
<div class="codehilite"><pre><span></span><code><span class="k">For</span> <span class="nv">model_1</span>, <span class="nv">area_2</span> <span class="o">~</span> <span class="nv">_6</span> <span class="nv">are</span> <span class="nv">used</span> <span class="nv">as</span> <span class="nv">the</span> <span class="nv">training</span> <span class="nv">data</span> <span class="nv">set</span>, <span class="nv">and</span> <span class="nv">area_1</span> <span class="nv">is</span> <span class="nv">used</span> <span class="nv">as</span> <span class="nv">the</span> <span class="nv">test</span> <span class="nv">data</span> <span class="nv">set</span>. 
<span class="k">For</span> <span class="nv">model_2</span>, <span class="nv">area_1</span>, <span class="nv">_3</span> <span class="o">~</span> <span class="nv">_6</span> <span class="nv">are</span> <span class="nv">used</span> <span class="nv">as</span> <span class="nv">the</span> <span class="nv">training</span> <span class="nv">data</span> <span class="nv">set</span> <span class="nv">and</span> <span class="nv">area_2</span> <span class="nv">is</span> <span class="nv">used</span> <span class="nv">as</span> <span class="nv">the</span> <span class="nv">test</span> <span class="nv">data</span> <span class="nv">set</span>
...
</code></pre></div>


<p>Note that S3DIS dataset paper uses a different 3-fold training, which was not publicly announced at the time of our work.
* Chage the value of <strong>"NUM_CLASSES"</strong> in the "batch_inference.py" 
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot; NUM_CLASSES = 13 &quot;&quot;&quot;</span>
<span class="n">NUM_CLASSES</span> <span class="o">=</span> <span class="mi">5</span>
</code></pre></div>
For example, to test model_6, using the below command:
<div class="highlight"><pre><span></span><code>$ python batch_inference.py --model_path log_5cls/model.ckpt --dump_dir log_5cls/dump --output_filelist log_5cls/output_filelist.txt --room_data_filelist meta/area6_data_label.txt --visu
</code></pre></div>
&ndash;model_path : The path where model.ckpt file is stored<br />
&ndash;dump_dir : The folder where forecasted results are stored<br />
&ndash;output_filelist : Set file path/name where the path of the prediction result is stored<br />
&ndash;room_data_filelist : .npy file path to test<br />
&ndash;visu : Use when visualizing  </p>
</li>
<li>
<p>Check the result  </p>
<ul>
<li>Check the result with CloudCompare.</li>
</ul>
</li>
</ol>
<h3 id="2-generate-citygml-data-from-point-cloud">2) Generate CityGML data from point cloud<a class="headerlink" href="#2-generate-citygml-data-from-point-cloud" title="Permanent link"></a></h3>
<ol>
<li>
<p>Run <strong>PostgreSQL pgadmin</strong></p>
</li>
<li>
<p>Run <strong>PinSout</strong>  </p>
<ul>
<li>Modify the contents of area_data_label to "data/<strong><em>your result folder</em></strong>/Area_1_office_1.npy"</li>
<li>Add the PinSout's files in <strong>sem_seg</strong></li>
<li>We are conducting the three functions in the <strong>batch_inference.py</strong></li>
<li><strong><em>Semantic Segmentation</em></strong> - Classify semantics from point
<div class="highlight"><pre><span></span><code><span class="s2">&quot;&quot;&quot; Ceiling &quot;&quot;</span>
<span class="s2">if pred[i] == 0:</span>
<span class="s2">cnt_ceiling += 1</span>
<span class="s2">coord_ceiling = str(pts[i, 6]) + &#39; &#39; + str(pts[i, 7]) + &#39; &#39; + str(pts[i, 8]) + &#39;</span><span class="se">\n</span><span class="s2">&#39;</span>
<span class="s2">ceiling_list.append(coord_ceiling)</span>
<span class="s2">ceiling_list2.append([pts[i, 6], pts[i, 7], pts[i, 8]])</span>
<span class="s2">fout_ceiling_label.write(&#39;ply</span><span class="se">\n</span><span class="s2">&#39;</span>
<span class="s2">                         &#39;format ascii 1.0</span><span class="se">\n</span><span class="s2">&#39;</span>
<span class="s2">                         &#39;element vertex </span><span class="si">%d</span><span class="se">\n</span><span class="s2">&#39;</span>
<span class="s2">                         &#39;property float x</span><span class="se">\n</span><span class="s2">&#39;</span>
<span class="s2">                         &#39;property float y</span><span class="se">\n</span><span class="s2">&#39;</span>
<span class="s2">                         &#39;property float z</span><span class="se">\n</span><span class="s2">&#39;</span>
<span class="s2">                         &#39;end_header</span><span class="se">\n</span><span class="s2">&#39; </span><span class="si">% c</span><span class="s2">nt_ceiling)</span>
<span class="s2">fout_ceiling_label.writelines(ceiling_list)</span>
<span class="s2">ceiling_cloud = pc.PointCloud() </span>
<span class="s2">ceiling_cloud.from_array(np.asarray(ceiling_list2, dtype=np.float32))</span>
</code></pre></div></li>
<li><strong><em>Polygonization</em></strong> - Construct polygons from point
<div class="highlight"><pre><span></span><code><span class="n">make_gml_data2</span> <span class="o">=</span> <span class="n">mcd2</span><span class="o">.</span><span class="n">MakeCityGMLData</span><span class="p">(</span><span class="n">pred_cloud</span><span class="p">,</span> <span class="n">ceiling_cloud</span><span class="p">,</span> <span class="n">floor_cloud</span><span class="p">,</span> <span class="n">wall_cloud</span><span class="p">,</span> <span class="n">door_cloud</span><span class="p">,</span> <span class="n">window_cloud</span><span class="p">)</span>
<span class="n">wall_surface</span><span class="p">,</span> <span class="n">ceiling_surface</span><span class="p">,</span> <span class="n">floor_surface</span><span class="p">,</span> <span class="n">door_surface</span><span class="p">,</span> <span class="n">window_surface</span> <span class="o">=</span> <span class="n">make_gml_data2</span><span class="o">.</span><span class="n">make_point_surface</span><span class="p">()</span>
</code></pre></div></li>
<li><strong><em>Featurizaiotn</em></strong> - Mapping between semantic features and surfaces
<div class="highlight"><pre><span></span><code><span class="n">make_gml_file2</span> <span class="o">=</span> <span class="n">gml2</span><span class="o">.</span><span class="n">PointCloudToCityGML</span><span class="p">(</span><span class="n">ceiling_surface</span><span class="p">,</span> <span class="n">floor_surface</span><span class="p">,</span> <span class="n">wall_surface</span><span class="p">,</span> <span class="n">door_surface</span><span class="p">,</span> <span class="n">window_surface</span><span class="p">)</span>
<span class="n">make_gml_file2</span><span class="o">.</span><span class="n">MakeRoomObject</span><span class="p">()</span>
</code></pre></div></li>
<li>Running the <strong>"batch_inference.py"</strong>
<div class="highlight"><pre><span></span><code>$ python batch_inference.py --model_path log_5cls/model.ckpt --dump_dir log_5cls/dump --output_filelist log_5cls/output_filelist.txt --room_data_filelist meta/Your area_data_label.txt --visu
</code></pre></div></li>
</ul>
</li>
<li>
<p>Export to CityGML file </p>
<ul>
<li>Check the result using <strong>pgadmin</strong> or <strong>3DCityDB importer&amp;exporter</strong>.</li>
<li>Export the CityGML file using <strong>3DCityDB importer&amp;exporter</strong>.</li>
</ul>
</li>
<li>
<p>Check the CityGML file  </p>
<ul>
<li>Run the FZK Viewer to visualize the CityGML file.</li>
<li>Select and execute the "Local CRS" at the bottom of the Spatial Reference System.</li>
</ul>
</li>
</ol>
<h2 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link"></a></h2>
<p>For detail information about usage, please see the <a href="https://github.com/aistairc/PinSout/wiki">User Guide</a>
* <a href="https://github.com/aistairc/PinSout/wiki/Make_CityGML_Data">Polygonization</a>
* <a href="https://github.com/aistairc/PinSout/wiki/PointCloud_To_CityGML">Featurizaiotn</a>
* <a href="https://github.com/aistairc/PinSout/wiki/Point_Sort">Point list sorting</a></p>
<h2 id="license">License<a class="headerlink" href="#license" title="Permanent link"></a></h2>
<p>This project is licensed under the <a href="https://opensource.org/licenses/MIT">MIT</a> licenses. - see the <a href="https://github.com/aistairc/PinSout/blob/master/LICENSE">LICENSE</a> file for details</p>
<h2 id="contact">Contact<a class="headerlink" href="#contact" title="Permanent link"></a></h2>
<p>Should you have any questions, comments, or suggestions, please contact me at <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#99;&#104;&#111;&#45;&#119;&#105;&#106;&#97;&#101;&#64;&#97;&#105;&#115;&#116;&#46;&#103;&#111;&#46;&#106;&#112;">&#99;&#104;&#111;&#45;&#119;&#105;&#106;&#97;&#101;&#64;&#97;&#105;&#115;&#116;&#46;&#103;&#111;&#46;&#106;&#112;</a></p>
<p><strong><em>Wijae Cho</em></strong></p>
<p><a href="https://www.airc.aist.go.jp/en/dprt/">https://www.airc.aist.go.jp/en/dprt/</a></p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020 National Institute of Advanced Industrial Science and Technology <a href="https://www.aist.go.jp/index_en.html"  target="_blank" rel="noopener"> AIST</a>

          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/aistairc/dprt-mf" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 002 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0012 2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://github.com/aistairc/dprt-mf" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8h5z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="assets/javascripts/vendor.c3dc8c49.min.js"></script>
      <script src="assets/javascripts/bundle.f9edbbd5.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: ".",
          features: ["tabs"],
          search: Object.assign({
            worker: "assets/javascripts/worker/search.8e2cddea.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="extra.js"></script>
      
    
  </body>
</html>